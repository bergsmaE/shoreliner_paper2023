%  LaTeX support: latex@mdpi.com 
%  For support, please attach all files needed for compiling as well as the log file, and specify your operating system, LaTeX version, and LaTeX editor.

%=================================================================
\documentclass[remotesensing,article,submit,pdftex,moreauthors]{Definitions/mdpi} 

%=================================================================
% MDPI internal commands - do not modify
\firstpage{1} 
\makeatletter 
\setcounter{page}{\@firstpage} 
\makeatother
\pubvolume{1}
\issuenum{1}
\articlenumber{0}
\pubyear{2023}
\copyrightyear{2023}
%\externaleditor{Academic Editor: Firstname Lastname}
\datereceived{ } 
\daterevised{ } % Comment out if no revised date
\dateaccepted{ } 
\datepublished{ } 
%\datecorrected{} % For corrected papers: "Corrected: XXX" date in the original paper.
%\dateretracted{} % For corrected papers: "Retracted: XXX" date in the original paper.
\hreflink{https://doi.org/} % If needed use \linebreak
%\doinum{}
%\pdfoutput=1 % Uncommented for upload to arXiv.org

\newcommand{\myfigure}[4]{
    \begin{figure*}[h!]
        \centering
        \includegraphics[width=#4\textwidth]{#1}	 
        \caption{\itshape#2}
        \label{#3}
    \end{figure*} 
}


%=================================================================
% Full title of the paper (Capitalized)
\Title{Sub-pixel shoreline extraction method using multi-spectral satellite imagery}

% MDPI internal command: Title for citation in the left column
\TitleCitation{A sub-pixel shoreline extraction method using multi-spectral satellite imagery}

% Author Orchid ID: enter ID or remove command
\newcommand{\orcidauthorA}{0000-0002-7638-1108} % Add \orcidA{} behind the author's name
%\newcommand{\orcidauthorB}{0000-0002-7638-1108} % Add \orcidB{} behind the author's name

% Authors, for the paper (add full first names)
\Author{Erwin W.J. Bergsma $^{1}$*\orcidA{}, Adrien Klotz $^{1,2}$, St\'{e}phanie Artigues$^{1}$, Marcan Graffin$^{1,2}$, Anna Prenowitz $^{1}$, Rafael Almar$^{2}$}

%\longauthorlist{yes}

% MDPI internal command: Authors, for metadata in PDF
\AuthorNames{Erwin W.J. Bergsma, Adrien Klotz, St\'{e}phanie Artigues, Marcan Graffin, Anna Prenowitz and Rafael Almar}

% MDPI internal command: Authors, for citation in the left column
\AuthorCitation{Bergsma, E.W.J.; Klotz, A.; Artigues, S.; Graffin, M, Prenowitz, A., Almar, R}
% If this is a Chicago style journal: Lastname, Firstname, Firstname Lastname, and Firstname Lastname.

% Affiliations / Addresses (Add [1] after \address if there is only one affiliation.)
\address{%
$^{1}$ \quad CNES (French Space Agency), Earth Observation Lab, 18 Av. Edouard Belin, 31400, Toulouse, France; \\
$^{2}$ \quad IRD-LEGOS (Research Institute Pour Le Developpement - Laboratoire d’Etudes en Geophysique et Oceanographie Spatiales), UMR5566, 14 Av. Edouard Belin, 31400, Toulouse, France;}

% Contact information of the corresponding author
\corres{Correspondence: erwin.bergsma@cnes.fr}

% Abstract (Do not insert blank lines, i.e. \\) 
\abstract{Abstract at the end}

% Keywords
\keyword{keyword 1; keyword 2; keyword 3 (List three to ten pertinent keywords specific to the article; yet reasonably common within the subject discipline.)} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
Sandy coasts around the world are in constant search for the natural equilibrium with the environmental forcing it is exposed to. This natural morphodynamic behaviour is often controlled by human interventions to serve the goal of dictating our coastal environment so it becomes predictable and manageable. It is this anthropogenic pressure that lies at the root of concepts such as coastal risks/hazards and solutions such as hard coastal structures. Without this anthropogenic pressure, there is just the natural movement of the shoreline at varying spatiotemporal scales. Erosion and accretion often have a direct effect on populations that live from the sea and reside in its vicinity. As a general concept, the shoreline position is a solid proxy (not a holistic view) for beach health and degree of protection; the wider your beach, the greater your buffer between land and sea, the greater your protection against environmental conditions and lower the (flooding) risk. Hence, measuring the shoreline can enable us to observe natural morphology, predict future shoreline positions and deduct coastal risk indicators from them.

It is important to note that different shoreline-related questions require different and adequate spatial-temporal scales of data to be answered. Where the shoreline can be measured by GPS, one cannot expect to have a measurement every hour. While shore-based video camera systems can deliver a shoreline position almost on an instant basis every 10-min they only cover local scales. Satellites can provide a sweet mean between the two, where freely available global optical satellite data is now acquired at least every 5 days, and by combining a suit of satellites in orbits this can be brought down to near-daily. So where it traditionally required quite an effort and financial investment to occasionally measure coastal indicators like the shoreline, we now benefit from data and infrastructure to analyse a local beach using a simple laptop with an internet connection and scale up to regional and even global studies if deployed on High-Performance cluster infrastructures. 

The shoreline can be defined in a multiple ways. In this work we focus on detecting the instantaneous waterline at the moment of sensing the satellite image. While the shoreline can be estimated using non-optical data, in this work we focus on optical satellites only and we presume that the whole satellite image is acquired at the same instant (which is not the case and can be 20-40\% of a typical swash period --BINET). Optical satellite imagery is typically used to create indices like for example widely used NDWI (Normalised Difference Water Index) or AWEI$_{sh}$ that are thresholded to find the land/sea limit. Conceptually this is what implementations like CoastSat, CASSIE, PyIntertidalDEM and ECFAS employ to find the instantaneous waterline with differences their workflow and accessibility. Unfortunately, non of these methods have proven to be at the same time robust to many coastal environments, fully automated while being fast enough to enable large scale and temporal studies and require manual interventions. Here, we aim to fully automatically detect the shoreline as accurate and computationally efficient as possible through the creation of a radio-metrically optimised indicator and integration in the CNES-HPC. At first we start with Sentinel-2 data as all Sentinel-2 satellite data is directly available on the CNES-HPC to the computational core, which allows for large spatio-temporal scale applications within a reasonable time-frame.

In sections below we set out the optimisation of a radiometric index to optimally separate land and sea using past knowledge on a variety of approaches. We set out the processing pipeline to extract the water index and find the optimum land sea limit. The method is mainly developed on the Atlantic coast of France and is then validated without modification in other parts of the world like Saint Louis in Senegal and around the FRF at Duck in the USA. In the discussion section limits, large scale applications and the transferability to other satellite optical sensors, notably the Landsat series is discussed followed by the conclusions.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods}
\subsection{Water index retrieval}
As a general matter, satellite derived indices are often used to identify, measure, follow and analyse natural processus. Like a vegetation index can be used to trace the health of the vegetation, yield of agricultural crops and even the likelihood to be a hotspot for musquitos. Water indices are more used to distinguish water from land, to detect lakes, rivers, floods and similarly in the coastal zone to detect the instantaneous water line. Propabily one of the most used and well know indices is the Normalised Difference Water Index. Normalised, so panshapening has no effect.






An index is the result of a combination of spectral bands from the same acquisition.
Physically speaking an illuminated body has it own reflective signature over the electromagnetic spectrum.
Hence, the right combination of the different spectral bands gives an image that emphasizes more a particular feature than an other in the same scene.
This is how indices work as it helps to distinguish certain bodies from a scene.
We can categorize indices into one of the three following categories depending on its formula.
First, ratio based indices perform a ratio between bands or a combination of bands.
Indices widely used in the literature such as the Normalized Difference Water Index (NDWI) \citep{GAO1996257} and the Modified Normalized Difference Water Index (MNDWI) \citep{Xu2006} are based on a band ratio.
Moreover, the normalized difference means that their value are bounded between 1 and -1.
For example, a pixel with a NDWI value close to -1 is very likely to be a water pixel and inversely a pixel with NDWI value close to 1 is very likely to be a land pixel.

Second category, the subtractive indices result from the subtraction (or addition) of spectral bands.
The most used subtractive water index is the Automated Water Extraction Index (AWEI) \citep{FEYISA201423}, it has been designed in 2014 to automatically extract water bodies present on Landsat acquisitions.
Subtractive indices generally use more spectral bands than ratio based index, making them not available for high-resolution satellite missions like Pleiades using less spectral bands than Landsat or Sentinel-2.
The advantages of the subtractive water indices compared to ratio based indices is discussed in the next paragraph.

The third category is the combination of bands in the false-RGB color space, also called RGB composition.
Three spectral bands are put in a RGB color space to give an new image.
This resulting image is not a greyscale image as with ratio-based and subtractive indices.
Then a colorimetric analysis of the false-RGB image allows the detection of features like water bodies.\citep{PEKEL2014704}
Such a method was used by \citep{Khan2019} to extract shorelines at different stages of the tide into the vast coastal region of the Bengal delta. % Is it pertinent to talk about this ?
\par

Among this variety of indices available with Sentinel-2 L1C acquisitions, the AWEI has been demonstrated to be the most accurate index to extract water for several reasons.
It is designed to enhance spectral contrast resulting in a more accurate mapping of surface water bodies than MNDWI.
Also, it is meant to present a stable optimal threshold for an accurate classification around the 0 value.
AWEI exists under two forms: AWEI for images with shadows called AWEIsh and and without shadows called AWEInsh. \citep{FEYISA201423}
\begin{equation}
    AWEIsh = B + 2.5 \times G - 1.5 \times (NIR + SWIR_1) - 0.25 \times SWIR_2
\end{equation}
\begin{equation}
    AWEInsh = 4\times( G - SWIR_1) - (0.25 \times NIR + 2.75 \times SWIR_2)
\end{equation}

In term of waterline extraction, AWEI has been demonstrated to present the highest accuracy compared to MNDWI and NDWI in different environments like sandy beaches, artificial coastlines, rocky coastlines, wetlands and mudflats.
This result can be explained by the fact that a subtractive index like AWEI has a linear response with respect to the fractional composition of land and water within a pixel whereas the response of a ratio based index like NDWI and MNDWI is non-linear. \citep{Bishop_sub_pixel}

However, even if the AWEI performs the best compared to other existing water indices for surface water extraction, AWEI is not optimised for intertidal areas where the waterline indicator lies.
Namely, AWEInsh classify rocks and dark land bodies as water.
Although robust in most environments, AWEIsh tends to classify wet sand areas as water.
This behavior is particularly problematic when acquisitions occur during the low tide period, when wet sand areas are abundant in the intertidal zone.
% Do we need a figure of AWEI failling with wet sand ?
As a result, it appears that the most robust index in almost all environments is the AWEIsh index and therefore provides a solid basis for deriving a specific index suitable for automated shoreline extraction.

\subsection{Spectral response of the intertidal zone}

\myfigure{img/band_compare_CAPBRETON.png}{Example of the spectral response of the 5 areas of the intertidal zone identified on the Sentinel-2 L1C acquisitions. The instantaneous waterline (land/water limit marker) is the most discernible shoreline indicator on these acquisitions.}{band_compare}{1}

In order to understand the results of the AWEI in the intertidal zone, we performed a study of the cross-shore beach environment, namely we assessed the spectral responses of the different areas of the intertidal zone on the Sentinel-2 acquisitions.
On the L1C S2 acquisitions of various coastlines in the world, there are at most 5 identifiable areas along a cross-shore line.
The 5 areas identified in Fig.\ref{band_compare} are in landward order: open water or simply water, white-water also known as surf zone, wet sand, dry sand and land.
By definition in the intertidal zone, there are always the open water and land areas. 
Then depending on the site, the date, the tide level and the weather, white-water, wet-sand and dry-sand areas are present or not in the intertidal zone.
Each area has its own spectral signature.
We compared the response of the Sentinel-2 spectral bands used in the AWEIsh for each area of the intertidal.
Hence the comparison involves the Blue, Green, Near Indra-Red (NIR), Short Wave Infra-red 1 and 2 (SWIR1, SWIR2) bands, respectively the bands B02, B03, B08, B11 and B12 of the Sentinel-2 MSI.
Hereafter is described in detail the spectral response of the different cross-shore areas, note that the values presented are the pixel value of the L1C bands corresponding to the measured reflected radiance multiplied by a factor 10000.
% Do we need to add a unit ?
Water has very low to close to 0 responses in NIR and SWIR1-2 bands and a medium ($\sim 1200$) response for blue and green bands.
Water is seen as very dark on most sensors resulting in a low SNR on every bands, moreover it absorbs almost every spectral response in the Infra-red domain.
White-water is the result of the waves breaking in the so-called surf zone.
When they break, air is trapped into water and forms bubbles and in presence of organic materials it forms a white foam.
That is why this zone generally appears white hence the name white-water.
Its spectral response is high in blue, green and NIR bands ($\sim 4500$) but stays low for SWIR bands ($\le 1000$).
It is worth mentioning that the blue and green bands are always higher than the NIR band in this zone.
Wet sand is characterized by a greater response of the NIR band compared to the green and blue and a progressive increase of the response of the SWIR bands.
The position where the NIR band becomes greater than the blue and green bands constitutes the clearer interface between 2 areas in the intertidal zone. 
This boundary corresponds to the instantaneous waterline indicator we want to extract from the acquisition.
The sand area exhibits a medium response for the blue and green bands ($\sim 2000$) but also a high response of the 3 Infra-Red bands.
Ultimately, the land area has a medium response for all bands ($\sim 1000$) excepted for the NIR band.
On land, NIR has generally a greater response than any other bands but we remark that NIR also presents a greater variability compare to the other bands.
As a conclusion, one can remark on the L1C S2 acquisitions that the intertidal zone is characterized by a clear delimitation corresponding to the instantaneous waterline indicator.
This boundary represents the transition between a greater response of the blue and green bands on the water side and a greater response of the NIR band on the land side.

\subsection{SCoWI: Optimized water index for costal zones}\label{SCOWI_sec}

\myfigure{img/SCoWI_estimation.png}{Comparison of the estimated values of the SCoWI (orange bars) against the AWEIsh (blue bars) over the 5 areas of the intertidal zone. The SCoWI has a very much lower estimated value than AWEIsh on the white-water and wet sand area, optimising the extraction of the waterline indicator.}{SCoWI_estimation}{1}

In a second time, we estimated the response of the AWEIsh applied on the 5 areas of the intertidal zone.
To perform this estimation, for the 5 areas of the intertidal zone cited before we recovered the mean value of each band involved in the AWEIsh computation (B, G, NIR, SWIR1 and SWIR2).
The mean value is computed based on measurements performed on cross-shore transects over 4 sand beaches that are representative of the beach diversity. %(Not sure how to say that) 
Then simply applying the AWEIsh formula gives an estimation of the AWEIsh values over the 5 areas.
The estimation of the AWEIsh values is displayed as blue bars in Fig.\ref{SCoWI_estimation}.
The most remarkable results is that wet sand value is equal to 1800.
As a reminder the theoretical threshold value of the AWEIsh is 0, above 0 the pixel is considered as water.
So following the theory most of the wet sand pixel are classified as water.
This explain the fact that AWEIsh gives wrong results in presence of wet sand during our tests.
Also from the estimation, white water pixels give an excessively high value that could form a third distribution peak which is not ideal for the application of an automatic threhsolding method assuming a bimodal distribution.

Therefore starting from the AWEIsh formula we obtained a new index optimised for the extraction of the waterline indicator. 
We aimed at lowering the estimated value of the wet sand area to bring it closer to the land value ($\le 0$) and lower the white water area to assimilate it to the water distribution.
This should be done without modifying too much the estimated value on the other areas.
This new index emphasizing the waterline interface is called "Subtractive Coastal Water Index" or SCoWI.
We obtained the following SCoWI formula satisfying the estimation objectives:
\begin{equation}
    SCoWI = B + 2 \times G - 2 \times NIR - 0.75 \times SWIR_1 - 0.5 \times SWIR_2
\end{equation}
The estimated values of the SCoWI in Fig.\ref{SCoWI_estimation} as orange bars show a general offset around $-600$. 
More importantly added to this offset, a lowering of the value of the white water estimation by $-3000$ and by $-1000$ for the wet sand pixels.
This results was obtained by using more of the NIR band by 0.5 and less Green band by 0.5 on our water index than the AWEIsh formulation.
This emphasize the transition when NIR reponse becomes greater than visible bands between the white-water and the wet-wand, namely the instantaneous waterline.
Ultimately, SWIR bands permit to adjust the SCoWI response over the different areas of the intertidal zone.
        
\subsection{Waterline extraction process}\label{extract_process}
This section presents the process involved to extract the instantaneous waterline indicator on L1C Sentinel-2 acquisitions as well as the pre-processing to apply to these acquisitions.
Following the method proposed by \citep{Bishop_sub_pixel}, a refined and robust process using the SCoWI presented before and a new histogram threhsolding procedure extracting sub pixel waterline is described.

\subsubsection{Pre-processing Sentinel-2 acquisitions}
On-board Sentinel-2 the MultiSpectral Instrument (MSI) measures the Earth's reflected radiance in the nadir direction in 13 spectral bands. 
The 13 bands are grouped in 3 different spatial-resolutions, 10 meter, 20 meters and 60 meters.
Sentinel-2 provides a systematic multispectral coverage of all land areas between 56 degrees South latitude (Cape Horn in South America) and 84 degrees North latitude (north of Greenland) including major islands (greater than 100 km$^2$ size), EU islands and all the other small islands located at less than 20 km from the coastline. 
Sentinel-2 has a revisit time going from 5 days at the equator up to 1 day on the highest latitudes. 
\citep{ESAreq}
S2-L1C products are radiometrically and geometrically corrected acquisition including ortho-rectification and spatial registration on a global reference system.
Per-pixel radiometric measurements are provided in Top Of Atmosphere (TOA) reflectance.
L1C products are systematically generated from the downlinked data in ESA's computation center
There are made available typically within 3 to 24 hours enabling a near-real time to non-time critical analysis.
Before performing the waterline extraction, we have to download and pre-process the S2-L1C products.
The pre-processing involves the downsampling to 10 meter resolution of the 20 meter SWIR bands using a cubic interpolation.
Also a CLOUD mask is computed from the combination of the cirrus and opaque cloud masks coming along with the S2-L1C products.
    
\subsubsection{Applying the SCoWI}
At this step we compute our water index optimized for the intertidal zone, the SCoWI.
SCoWI characteristics and formula are described in Sec.\ref{SCOWI_sec}.
We apply the formula using the native 10 meters bands B02 (blue), B03 (green), B08 (NIR), and to the downsampled 10 meter bands B11 and B12 (SWIR1 and SWIR2).
This step produces a greyscale image with unbounded values.
In theory, pixel of the SCoWI greater than 0 are water pixels and the image should present a bimodal distribution histogram.
Finally we apply NODATA and CLOUD masks computed during the pre-processing on the SCoWI to remove pixels that are not useful for our study.

\subsubsection{Local minimum histogram thresholding}
The indexing step is followed by a thresholding of the water index to then draw the waterline as an iso-countour of the index at a certain threhsold.
Methods extracting shoreline proxies involving automated threhsolding usually use the Otsu's method \citep{Bishop_sub_pixel, VOS2019_sub}.
Based on the assumption of a bimodal distribution on the SCoWI histogram.
The Otsu's threshold is determined by minimizing intra-class variance $\sigma_w^2$ of a list of values presenting a bimodal distribution. \citep{OTSU1979}
We pose $T_0$ as being the minimum value of the SCoWI image obtained at previous step and $T_N$ as being its maximum.
Then the Otsu's threshold is given by the following formula:
\begin{equation}
    t_{otsu} = \operatorname*{argmin}_t \sigma_w^2(t) \text{, where }T_0 \le t \le T_N
\end{equation}
Unfortunately, even if mathematically right it is very likely for the Otsu threhsold to lack of accuracy in cutting the 2 distributions on the histogram.
Physically speaking we should put a frontier between the 2 distributions where their both contributions are minimized.
Hereafter, we present our thresholding method refining the Otsu threshold that takes into account this minimum histogram condition called the local minimum histogram threhsolding.
After computing the Otsu threhsold on the SCoWI histogram, we find iteratively the peaks (or local maximums) of the histogram.
We then select an interval $[t_1 ; t_2]$ delimited by the closest peaks on each side of the Otsu threshold, so that $t_1 \le t_{otsu} \le t_2$ where $t_1$ and $t_2 \in [T_0;T_N]$ and are local maximums of the histogram.
Finally, the local minimum threshold $t_{min}$ is defined as the minimum argument of the histogram in the interval $[t_1 ; t_2]$.
This thresholding method ensures that the computed threshold to delimit the 2 distributions is close the point minimizing the intra-class variance of the histogram and that it is situated on a local minimum of the histogram at the same time. 
    
\subsubsection{Sub-pixel mapping applying the marching-square method}
Accurately mapping the instantaneous waterline indicator is not easy to achieve with medium resolution satellite imagery.
With Sentinel-2 images the waterline extraction accuracy is theoretically limited to at least 10 meters due to the spatial resolution of the sensor.
This limitation could be critical to obtain a correct shoreline mapping in some locations on the Earth.
Fortunately, we can go around this limitation with a sub-resolution mapping algorithm applying the local minimum threshold computed previously to extract sub-pixel resolution waterlines.
We make the assumption that pixels at 10 meters resolution along the waterline present a mix of water and land, and that water index values for these pixels directly reflects the relative proportion of water and land within those pixels. 
It should therefore be possible to compare the relative water index values of two neighbouring pixels, and use this comparison to more precisely locate the boundary between land and water than simply drawing a line directly at the center of pixels on the waterline.
The marching square algorithm linearly interpolates the SCoWI values of neighbouring pixels to map out the precise location of the waterline according to the specified threshold value.\citep{CIPOLLETTI201287}
To summarise, sub-pixel waterline position on an S2 acquisition corresponds to the iso-contour formed at the local minimum histogram threshold value $t_{min}$ on the SCoWI applied thanks to a marching-square with linear interpolation contour extraction algorithm.



\section{Validation}
In order to validate our Satellite Derived Shoreline extraction method and compare it with already existing extraction methods, it is necessary to asses its cross-shore accuracy. 

\subsection{Presentation of the site}
The validation process was conducted on the site of Duck.
Duck beach is located in North Carolina, USA, in front of the Atlantic ocean and houses the U.S. Army Engineer Research and Development Center’s Field Research Facility (FRF).
Since 1981, monthly to fortnightly in-situ high-quality topo-bathymetric surveys have been conducted on the FRF site. \citep{FORTE2017}
Also, the National Oceanic and Atmospheric Administration (NOAA) has installed since 1995 a water level sensor measuring the level of the sea at Duck every 6 minutes. \citep{park2014water}
It is also worth mentioning that this site was not among the representative beaches used to optimize the SCoWI. % Useful ?
\par

\subsection{Comparison of extracted waterline vs in-situ measurements}
The method proposed to validate the SDS extraction method consisted to compare the instantaneous waterlines extracted by our method with in-situ instantaneous waterline measurements.    
The comparison is facilitated due to the fact that Duck beach is linear, thus the waterlines positions are compared only in the cross-shore direction.
The validation was caried out in 4 steps.
First step, extraction of instantaneous waterlines from Sentinel-2 acquisition of DUCK site over a period of time ranging from August 2019 to August 2022 using the SCoWI thresholded with the local minimum histogram method combined to a marching square. (see Sec.\ref{extract_process})
In a second step, we kept only the extracted waterlines at which dates corresponded to a date of a topo-bathymetric survey on Duck Beach.
Then, we retrieved the measured water levels at the time of acquisition associated to each extracted waterline.
As it is measured every 6 minutes, the retrieved water level does not correspond exactly to the water level at the time of the S2 acquisition.
However the change of the water level within 6 minutes is considered negligible.
Finaly, the in-situ measured waterline then corresponds to the contour line at water level measured at the time of Sentinel-2 acquisition projected on the topo-bathymetric survey of the day.\par
We extracted 106 waterlines from Sentinel-2 acquisitions of DUCK site over a period of time from August 2019 to August 2022.
Among these 106 Sentinel-2 acquisitions, 6 occurred on the same day of a topo-bathymetric survey at Duck.
Hence 6 waterlines extracted from our method were compared to in-situ measured waterlines.
The comparison showed a cross-shore position error of the extracted waterlines of 2.6 meters RMSE at best corresponding to 1/4 of the Sentinel-2 pixel. (see Fig.\ref{validation})
We can see that 5 of the 6 comparisons exhibit a cross-shore RMSE bellow 10 meters, that is to say under the Sentinel-2 pixel resolution.
Such sub-pixel performances demonstrate the ability of this proposed SDS extraction method to extract reliable instantaneous waterlines ranging from local to continental scales.

This extraction method produces comparable to even better results than state of the art SDS extraction method \citep{VOS2019_sub} in term of cross-shore RMSE.
In term of computation time using the same S2 acquisitions, our extraction method is 12 times faster in average than the state of the art extraction method presented in \citep{VOS2019_sub}.
% Shoreliner    2.237 s   x 1
% pyIntertid    3.245 s   x 1.45  x 1
% CoastSat      27.873 s  x 12.5  x 8.6
% Area of 348 km$^2$

\myfigure{img/Results.png}{Comparison of waterline extracted using the new extraction method proposed in this paper (green line) with the in-situ measured waterline (red line). The right-hand side histograms display the cross-shore error in the positions of the extracted waterline. The smallest the cross-shore RMSE achieved a value of 2.6 meters corresponding to 1/4 of the Sentinel-2 pixel.}{validation}{1}

\subsection{Improvement of the waterline extraction at low tide}
    The extraction of the shoreline proxies at low tide is a challenge in presence of a beach experiencing a meso-microtidal range ($>$2 m) and energetic incident waves. \citep{ALMAR2012, CASTELLE2021107707}
    At low tide, shallow pools of residual water and sand that is not already dried off appear in the intertidal zone.
    This so-called wet sand zone is located on the water side of the distribution with the AWEIsh.
    However, the wet sand should be classified on the land side to extract an accurate instantaneous waterline as its real position lies between the white-water and the wet sand areas. (see Fig.\ref{band_compare})
    The same problem is reported by \citep{VOS2019_sub} using MNDWI.
    To avoid this issue with such meso-macrotidal beach, shoreline proxies are measured only where the tide is higher than a certain threshold, essentially keeping the observations of high tide stages.
    This results in a loss of temporal resolution that is particularly detrimental to the study of rapid shoreline evolution.
    
    The SCoWI was optimized to solve such issues occuring in the intertidal zones at low tide stages. 
    The method we proposed was compared to the waterline resulting from the method of \citep{Bishop_sub_pixel}, namely AWEIsh thresholded by the Otsu's method.
    The validation was conducted on the Capbreton Beach in the bay of Biscay, SW France.
    This macro-tidal beach on the atlantic coast exhibits large portions of wet sand at low tide forming sandbars surrounded by large baïnes.
    An example of the Capbreton beach at low tide acquired by Sentinel-2 is provided in Fig.\ref{SCOWI_vs_AWEI_hist}.
    From this acquisition, the AWEIsh and SCoWI were computed.
    and their respective histograms displayed.
    Then instantaneous waterlines extracted with an Otsu's thresholding method are ploted in blue for the AWEIh and in green for the SCoWI.
    Also the SCoWI of the same S2 acquisition is thresholded using our local minimum histogram method, the resulting instantaneous waterline is ploted in red.
    It appears clearly that waterlines extracted with the SCoWI are closer to the actual waterline than the waterline extracted by the AWEIsh.
    Wet sand pixels form a little bump on the AWEIsh histogram between 1000 and 2000 and thus they are not assimilated into the land distribution with a peak at -1500.
    The SCoWI histogram presents a clearer distinction between the land and the water distribution with peaks at -2000 and 3000 respectively.
    Moreover with the SCoWI, the most accurate waterline was extracted using the local minimum histogram thresholding method.
    On the histogram, we observe that the Otsu threhsold cuts on part of the two distribution, resulting in an inaccurate classification of certain wet sand pixels 
    On the other hand, the local minimum histgram threhsold is computed between the 2 distributions where their both contributions are minimized.
    
    \myfigure{img/AWEIsh_vs_SCOWI2.png}{a) Sentinel-2 acquisition of Capbreton beach at low tide. Instantaneous waterlines extracted by the 3 methods compared are displayed in plain lines. Waterline extracted by the SCoWI combined to the local minimum histogram thresholding method (red line) is the closest to the actual waterline on the acquisition. b) AWEIsh histogram of this S2 acquisition. The dashed blue line is located at the Otsu's threhsold value computed for this histogram. c) SCoWI histogram of this S2 acquisition. The dashed green line is located at the Otsu's threhsold value computed for this histogram. The dashed red line is located at the local minimum histogram threhsold value computed for this histogram.}{SCOWI_vs_AWEI_hist}{1}

    
\section{Results and discussion}

    \subsection{Intertidal DEM}
    The combination between our extracted waterlines and a global tide model such a FES 2014 \citep{carrere2016fes} provides elevation measurements in the intertidal zone with a horizontal resolution of less than 10 meters.
    Topography derived from conventional remote sensing techniques on the intertidal zone is missing.
    Uniformity of the sand and high variability of the intertidal zone explain why techniques based on stereoscopic acquisitions to derive the topography of a scene fail in the coastal environment.
    The intertidal DEM obtained based on 3D extracted water lines is a very interesting result for coastal researchers in terms of modeling and monitoring the elevation of these crucial areas where topography and bathymetry meet.
    An example of intertidal DEM is provided in Fig.\ref{HENDAYE_topo}.
    However, caution must be taken when performing an intertidal DEM.
    The DEM is valid only for aggregation of extracted waterlines acquired over a short period ranging from months to years depending on the site of the study.
    The morphological evolutions of coastlines induced by erosion and accretion over long periods make the resulting DEM incoherent and thus not representative of the reality.
    
    \myfigure{img/HENDAYE_shoreline_DEM.png}{An example of intertidal DEM on Hendaye beach, SW France. It was obtained from the combination of the extracted instantaneous waterlines and the predicted water levels of each waterline point with FES2014 global tide model of Sentinel-2 acquisition from XX to XX.}{HENDAYE_topo}{1}

    \subsection{Shoreline evolution monitoring at continental and local scale}
    STLOUIS example + a Figure ?


    \subsection{Discussion ( or Limitations ?)}
    Limitations:
    - Presence of shadows induced by cliffs
    - Shallow waters such as atolls
    - Tide elevation model

    - Help of AI but at what cost ?
    - Adaptative index ?

\section{Conclusion}
TBD

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Patents}

This section is not mandatory, but may be added if there are patents resulting from the work reported in this manuscript.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vspace{6pt} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% optional
%\supplementary{The following supporting information can be downloaded at:  \linksupplementary{s1}, Figure S1: title; Table S1: title; Video S1: title.}

% Only for the journal Methods and Protocols:
% If you wish to submit a video article, please do so with any other supplementary material.
% \supplementary{The following supporting information can be downloaded at: \linksupplementary{s1}, Figure S1: title; Table S1: title; Video S1: title. A supporting video article is available at doi: link.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\authorcontributions{For research articles with several authors, a short paragraph specifying their individual contributions must be provided. The following statements should be used ``Conceptualization, X.X. and Y.Y.; methodology, X.X.; software, X.X.; validation, X.X., Y.Y. and Z.Z.; formal analysis, X.X.; investigation, X.X.; resources, X.X.; data curation, X.X.; writing---original draft preparation, X.X.; writing---review and editing, X.X.; visualization, X.X.; supervision, X.X.; project administration, X.X.; funding acquisition, Y.Y. All authors have read and agreed to the published version of the manuscript.'', please turn to the  \href{http://img.mdpi.org/data/contributor-role-instruction.pdf}{CRediT taxonomy} for the term explanation. Authorship must be limited to those who have contributed substantially to the work~reported.}

\funding{Please add: ``This research received no external funding'' or ``This research was funded by NAME OF FUNDER grant number XXX.'' and  and ``The APC was funded by XXX''. Check carefully that the details given are accurate and use the standard spelling of funding agency names at \url{https://search.crossref.org/funding}, any errors may affect your future funding.}

\institutionalreview{In this section, you should add the Institutional Review Board Statement and approval number, if relevant to your study. You might choose to exclude this statement if the study did not require ethical approval. Please note that the Editorial Office might ask you for further information. Please add “The study was conducted in accordance with the Declaration of Helsinki, and approved by the Institutional Review Board (or Ethics Committee) of NAME OF INSTITUTE (protocol code XXX and date of approval).” for studies involving humans. OR “The animal study protocol was approved by the Institutional Review Board (or Ethics Committee) of NAME OF INSTITUTE (protocol code XXX and date of approval).” for studies involving animals. OR “Ethical review and approval were waived for this study due to REASON (please provide a detailed justification).” OR “Not applicable” for studies not involving humans or animals.}

\informedconsent{Any research article describing a study involving humans should contain this statement. Please add ``Informed consent was obtained from all subjects involved in the study.'' OR ``Patient consent was waived due to REASON (please provide a detailed justification).'' OR ``Not applicable'' for studies not involving humans. You might also choose to exclude this statement if the study did not involve humans.

Written informed consent for publication must be obtained from participating patients who can be identified (including by the patients themselves). Please state ``Written informed consent has been obtained from the patient(s) to publish this paper'' if applicable.}

\dataavailability{We encourage all authors of articles published in MDPI journals to share their research data. In this section, please provide details regarding where data supporting reported results can be found, including links to publicly archived datasets analyzed or generated during the study. Where no new data were created, or where data is unavailable due to privacy or ethical re-strictions, a statement is still required. Suggested Data Availability Statements are available in section “MDPI Research Data Policies” at \url{https://www.mdpi.com/ethics}.} 

\acknowledgments{In this section you can acknowledge any support given which is not covered by the author contribution or funding sections. This may include administrative and technical support, or donations in kind (e.g., materials used for experiments).}

\conflictsofinterest{Declare conflicts of interest or state ``The authors declare no conflict of interest.'' Authors must identify and declare any personal circumstances or interest that may be perceived as inappropriately influencing the representation or interpretation of reported research results. Any role of the funders in the design of the study; in the collection, analyses or interpretation of data; in the writing of the manuscript; or in the decision to publish the results must be declared in this section. If there is no role, please state ``The funders had no role in the design of the study; in the collection, analyses, or interpretation of data; in the writing of the manuscript; or in the decision to publish the~results''.} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Optional
\sampleavailability{Samples of the compounds ... are available from the authors.}

%% Only for journal Encyclopedia
%\entrylink{The Link to this entry published on the encyclopedia platform.}

\abbreviations{Abbreviations}{
The following abbreviations are used in this manuscript:\\

\noindent 
\begin{tabular}{@{}ll}
MDPI & Multidisciplinary Digital Publishing Institute\\
DOAJ & Directory of open access journals\\
TLA & Three letter acronym\\
LD & Linear dichroism
\end{tabular}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Optional
\appendixtitles{no} % Leave argument "no" if all appendix headings stay EMPTY (then no dot is printed after "Appendix A"). If the appendix sections contain a heading then change the argument to "yes".
\appendixstart
\appendix
\section[\appendixname~\thesection]{}
\subsection[\appendixname~\thesubsection]{}
The appendix is an optional section that can contain details and data supplemental to the main text---for example, explanations of experimental details that would disrupt the flow of the main text but nonetheless remain crucial to understanding and reproducing the research shown; figures of replicates for experiments of which representative data are shown in the main text can be added here if brief, or as Supplementary Data. Mathematical proofs of results not central to the paper can be added as an appendix.

\begin{table}[H] 
\caption{This is a table caption.\label{tab5}}
\newcolumntype{C}{>{\centering\arraybackslash}X}
\begin{tabularx}{\textwidth}{CCC}
\toprule
\textbf{Title 1}	& \textbf{Title 2}	& \textbf{Title 3}\\
\midrule
Entry 1		& Data			& Data\\
Entry 2		& Data			& Data\\
\bottomrule
\end{tabularx}
\end{table}

\section[\appendixname~\thesection]{}
All appendix sections must be cited in the main text. In the appendices, Figures, Tables, etc. should be labeled, starting with ``A''---e.g., Figure A1, Figure A2, etc.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{adjustwidth}{-\extralength}{0cm}
%\printendnotes[custom] % Un-comment to print a list of endnotes

\reftitle{References}

% Please provide either the correct journal abbreviation (e.g. according to the “List of Title Word Abbreviations” http://www.issn.org/services/online-services/access-to-the-ltwa/) or the full name of the journal.
% Citations and References in Supplementary files are permitted provided that they also appear in the reference list here. 

%=====================================
% References, variant A: external bibliography
%=====================================
\bibliography{refbiblio}

%=====================================
% References, variant B: internal bibliography
%=====================================


% If authors have biography, please use the format below
%\section*{Short Biography of Authors}
%\bio
%{\raisebox{-0.35cm}{\includegraphics[width=3.5cm,height=5.3cm,clip,keepaspectratio]{Definitions/author1.pdf}}}
%{\textbf{Firstname Lastname} Biography of first author}
%
%\bio
%{\raisebox{-0.35cm}{\includegraphics[width=3.5cm,height=5.3cm,clip,keepaspectratio]{Definitions/author2.jpg}}}
%{\textbf{Firstname Lastname} Biography of second author}

% For the MDPI journals use author-date citation, please follow the formatting guidelines on http://www.mdpi.com/authors/references
% To cite two works by the same author: \citeauthor{ref-journal-1a} (\citeyear{ref-journal-1a}, \citeyear{ref-journal-1b}). This produces: Whittaker (1967, 1975)
% To cite two works by the same author with specific pages: \citeauthor{ref-journal-3a} (\citeyear{ref-journal-3a}, p. 328; \citeyear{ref-journal-3b}, p.475). This produces: Wong (1999, p. 328; 2000, p. 475)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% for journal Sci
%\reviewreports{\\
%Reviewer 1 comments and authors’ response\\
%Reviewer 2 comments and authors’ response\\
%Reviewer 3 comments and authors’ response
%}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\PublishersNote{}
\end{adjustwidth}
\end{document}

